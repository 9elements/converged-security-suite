This package was initially implemented based on different libraries and then was stupidly ported keeping the changes minimal. As result the code is ugly, suboptimal and requires refactoring. Do not hesitate to do it :)